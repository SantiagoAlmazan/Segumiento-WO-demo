<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Panel Master - Control de Producci√≥n</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <nav>
    <a href="index.html">üè† Dashboard</a>
    <a href="cnc.html">CNC</a>
    <a href="molino.html">Molino</a>
    <a href="ensamble.html">Ensamble</a>
    <a href="lija.html">Lija</a>
    <a href="pintura.html">Pintura</a>
  </nav>

  <h1>üìã Panel Master</h1>

  <!-- Secci√≥n para crear nuevas WO -->
  <section class="crear-wo">
    <h2>Crear nueva Work Order (WO)</h2>
    <div class="form-crear">
      <input type="text" id="wo-id" placeholder="ID de WO">
      <input type="text" id="wo-desc" placeholder="Descripci√≥n">
      <input type="number" id="wo-piezas" placeholder="Cantidad de piezas">
      <input type="text" id="wo-clasif" placeholder="Clasificaci√≥n">
      <button onclick="crearWO(
        document.getElementById('wo-id').value,
        document.getElementById('wo-desc').value,
        document.getElementById('wo-piezas').value,
        document.getElementById('wo-clasif').value
      )">‚ûï Agregar WO</button>
    </div>
  </section>

  <!-- Tabla de TODAS las WO activas -->
  <section class="tabla-master">
    <h2>√ìrdenes activas</h2>
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>Descripci√≥n</th>
          <th>Piezas</th>
          <th>Clasificaci√≥n</th>
          <th>Estaci√≥n actual</th>
          <th>Acci√≥n</th>
        </tr>
      </thead>
      <tbody id="tabla-master"></tbody>
    </table>
  </section>

  <script src="script.js"></script>
  <script>
    function actualizarTablaMaster() {
      const allWOs = JSON.parse(localStorage.getItem("workOrders")) || [];
      const tbody = document.getElementById("tabla-master");
      tbody.innerHTML = "";

      allWOs.forEach(wo => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${wo.id}</td>
          <td>${wo.descripcion}</td>
          <td>${wo.piezas}</td>
          <td>${wo.clasificacion}</td>
          <td>${wo.estado}</td>
          <td>
            <select onchange="moverWO('${wo.id}', this.value)">
              <option value="">Mover a...</option>
              <option value="En espera">En espera</option>
              <option value="CNC">CNC</option>
              <option value="Molino">Molino</option>
              <option value="Ensamble">Ensamble</option>
              <option value="Lija">Lija</option>
              <option value="Pintura">Pintura</option>
            </select>
          </td>
        `;
        tbody.appendChild(tr);
      });
    }

    function moverWO(id, nuevaEstacion) {
      if (!nuevaEstacion) return;

      const clave = prompt("Ingrese la contrase√±a del encargado:");
      if (clave !== "123") {
        alert("‚ùå Contrase√±a incorrecta");
        actualizarTablaMaster();
        return;
      }

      const allWOs = JSON.parse(localStorage.getItem("workOrders")) || [];
      const wo = allWOs.find(w => w.id === id);
      if (wo) {
        wo.estado = nuevaEstacion;
        localStorage.setItem("workOrders", JSON.stringify(allWOs));
        alert(`‚úÖ La WO ${id} ha sido movida a ${nuevaEstacion}`);
        actualizarTablaMaster();
      }
    }

    document.addEventListener("DOMContentLoaded", actualizarTablaMaster);
  </script>

 </body>
</html>
